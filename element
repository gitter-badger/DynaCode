tname = false
function Initialize( tableName )
	if tname then error"Cannot re-initialize." end
	tableName = tableName or "eTable"
	-- Create a new table for elements to be stored.
	_G[tableName] = {}
	tname = _G[tableName]
	return tableName
end

function create( text, x, y, callback, width, height, padding, tc, bg, otc, obg, toggle, stc, sbg, secText, group )
	if not tname then
		error"Called create before Initialize. Call API Initialize first!"
	end
	new = {}
	setmetatable( new, {__index = self} )
	new.text = text or "No Text"
	new.x = x or 1
	new.y = y or 1
	new.width = width or #new.text
	new.height = height or 1
	new.padding = padding or 5
	new.tc = tc or colors.white
	new.bg = bg or colors.red
	new.otc = otc or colors.white
	new.obg = obg or colors.black
	new.toggle = toggle or false
	new.stc = stc or new.tc
	new.sbg = sbg or new.sbg
	new.secText = secText or new.text
	new.group = group
	new.callback = callback or function() end
	new.toggled = false
	new.visible = true
	new.toggle = function( self )
		-- Toggle click state of element
		if self.toggled then self.toggled = false else self.toggled = true end
		return self:draw()
	end
	new.toggleShow = function( self )
		if self.visible then self:hide() else self:show() end
	end
	new.hide = function( self )
		-- Hide element
		self.visible = false
		return self:draw()
	end
	new.show = function( self )
		-- Show element
		self.visible = true
		return self:draw()
	end
	new.groupSelect = function( self, group )
		-- Returns table of elements with a e.group matching [group]
	end
	new.remove = function( self )
		-- Removes element from draw buffer and replaces old space with obg
	end
	new.draw = function( self )
		-- Draw this element
		term.setCursorPos( self.x, self.y )
		if self.visible then
			if self.toggled then
				-- This element should use secondary vars
				term.setTextColor( self.stc )
				term.setBackgroundColor( self.sbg )
				self:drawPadding()
				term.write( self.secText )
			else
				term.setTextColor( self.tc )
				term.setBackgroundColor( self.bg )
				self:drawPadding()
				term.write( self.text )
			end
		else
			local text = false
			if self.toggled then text = self.secText else text = self.text end
			term.setBackgroundColor( self.obg )
			self:drawPadding()
			term.write( self.text )
			-- Remove from window
		end
		self:drawPadding()
		term.setTextColor( self.otc )
		term.setBackgroundColor( self.obg )
		return self -- Allows chaining of functions (like jQuery)
	end
	new.drawPadding = function( self )
		-- Draw padding
		for i = 1, self.padding do
			term.write(" ")
		end
	end
	new.addToDict = function( self )
		for k, v in ipairs( tname ) do
			if v == self then
				-- Remove from Dictionary
				table.remove( tname, k )
			end
		end
		table.insert( tname, self )
		print( tname )
		return self
	end
	new:addToDict()
	return new
end

function redrawAll()
	-- Redraws all elements, returns true if successful, else false
	if not tname then error"redrawAll called before Initialize. Call API Initialize first!" end
	for k, v in ipairs( tname ) do
		print( v )
	end
end

function click( e, button, x, y )
	-- Check if click location was on a button. If it was run the callback attached.
	if e == "mouse_click" then
		if x and y then
			-- Loop through elements and find a button at the location
			for i, v in ipairs(tname) do
				if x >= v.x and x < v.x + v.width + v.padding*2 and y >= v.y and y <= v.y+v.height-1 then
					v.callback()
				end
			end
		end
	end
end

